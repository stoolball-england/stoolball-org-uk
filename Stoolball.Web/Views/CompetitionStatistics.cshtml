@inherits UmbracoViewPage<StatisticsSummaryViewModel<Competition>>
@using Stoolball.Web.Statistics.Models
@using Stoolball.Competitions
@using Stoolball.Matches
@using Stoolball.Statistics
@using Stoolball.Web.Filtering
@{
    SmidgeHelper.RequiresCss(new CssFile("/css/statistics.min.css") { Order = 100 });
    SmidgeHelper.RequiresJs(new JavaScriptFile("/js/filter.js") { Order = 100 });
    SmidgeHelper.RequiresCss(new CssFile("/css/filter.min.css") { Order = 100 });

    var individualScores = new StatisticsViewModel<PlayerInnings>(Model) { ShowCaption = true, ShowPlayerColumn = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter };
    individualScores.Results.AddRange(Model.PlayerInnings);
    var bowlingFigures = new StatisticsViewModel<BowlingFigures>(Model) { ShowCaption = true, ShowPlayerColumn = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter };
    bowlingFigures.Results.AddRange(Model.BowlingFigures);
    var mostRuns = new StatisticsViewModel<BestStatistic>(Model) { ShowCaption = true, ShowTeamsColumn = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter };
    mostRuns.Results.AddRange(Model.MostRuns);
    var mostWickets = new StatisticsViewModel<BestStatistic>(Model) { ShowCaption = true, ShowTeamsColumn = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter };
    mostWickets.Results.AddRange(Model.MostWickets);
    var mostCatches = new StatisticsViewModel<BestStatistic>(Model) { ShowCaption = true, ShowTeamsColumn = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter };
    mostCatches.Results.AddRange(Model.MostCatches);
}
<div class="container-xl">
    <h1>@Model.Context!.CompetitionNameAndPlayerType()</h1>

    @if (Model.Context.UntilYear.HasValue)
    {
        <p class="alert alert-info"><strong>This competition isn't played any more.</strong></p>
    }

    <ul class="nav nav-tabs">
        <li class="nav-item">
            <a class="nav-link" href="@Model.Context.CompetitionRoute">Summary</a>
        </li>
        <li class="nav-item">
            <em class="nav-link active">Statistics</em>
        </li>
        <li class="nav-item nav-item-admin">
            <button type="button" class="nav-link nav-link-filter">Edit filter</button>
        </li>
    </ul>
    @await Html.PartialAsync("_Filters", new FilterViewModel
    {
      FilteredItemTypePlural = "Statistics",
      FilterDescription = Model.FilterDescription,
      from = Model.AppliedFilter.FromDate,
      to = Model.AppliedFilter.UntilDate
    })

    @if (!Model.PlayerInnings.Any() && !Model.BowlingFigures.Any() && !Model.MostRuns.Any() && !Model.MostWickets.Any() && !Model.MostCatches.Any())
    {
        @await Html.PartialAsync("_NoData")
    }
    else
    {
        @await Html.PartialAsync("_IndividualScores", individualScores)
        @await Html.PartialAsync("_MostRuns", mostRuns)
        var defaultFilterFor50Runs = Model.DefaultFilter.Clone();
        defaultFilterFor50Runs.MinimumRunsScored = 50;
        var appliedFilterFor50Runs = Model.AppliedFilter.Clone();
        appliedFilterFor50Runs.MinimumRunsScored = 50;
        @await Html.PartialAsync("_MostScoresOfX", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = defaultFilterFor50Runs, AppliedFilter = appliedFilterFor50Runs })
        var defaultFilterFor100Runs = Model.DefaultFilter.Clone();
        defaultFilterFor100Runs.MinimumRunsScored = 100;
        var appliedFilterFor100Runs = Model.AppliedFilter.Clone();
        appliedFilterFor100Runs.MinimumRunsScored = 100;
        @await Html.PartialAsync("_MostScoresOfX", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = defaultFilterFor100Runs, AppliedFilter = appliedFilterFor100Runs })
        @await Html.PartialAsync("_BattingAverage", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter })
        @await Html.PartialAsync("_BattingStrikeRate", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter })
        @await Html.PartialAsync("_BowlingFigures", bowlingFigures)
        @await Html.PartialAsync("_MostWickets", mostWickets)
        var defaultFilterFor5Wickets = Model.DefaultFilter.Clone();
        defaultFilterFor5Wickets.MinimumWicketsTaken = 5;
        var appliedFilterFor5Wickets = Model.AppliedFilter.Clone();
        appliedFilterFor5Wickets.MinimumWicketsTaken = 5;
        @await Html.PartialAsync("_MostXWickets", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = appliedFilterFor5Wickets, AppliedFilter = appliedFilterFor5Wickets })
        @await Html.PartialAsync("_BowlingAverage", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter })
        @await Html.PartialAsync("_EconomyRate", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter })
        @await Html.PartialAsync("_BowlingStrikeRate", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter })
        @await Html.PartialAsync("_MostCatches", mostCatches)
        @await Html.PartialAsync("_MostRunOuts", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter })
        @await Html.PartialAsync("_PlayerPerformances", new StatisticsViewModel<PlayerIdentityPerformance>(Model) { ShowLinkOnly = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter })
        @await Html.PartialAsync("_PlayerOfTheMatchLink", new StatisticsViewModel<PlayerIdentityPerformance>(Model) { DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter })
        @await Html.PartialAsync("_MostPlayerOfTheMatchAwards", new StatisticsViewModel<BestStatistic>(Model) { ShowLinkOnly = true, DefaultFilter = Model.DefaultFilter, AppliedFilter = Model.AppliedFilter })
    }
</div>